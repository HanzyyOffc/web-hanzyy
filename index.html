<!DOCTYPE html>
<html lang="id">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Panel QR Pembayaran</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- ğŸ”’ PANEL MASUKKAN NAMA -->
<div id="welcomePanel" class="fixed inset-0 flex flex-col items-center justify-center bg-white z-50">
Â  <div class="bg-white p-6 rounded-xl shadow-md text-center">
Â  Â  <h2 class="text-xl font-semibold mb-4">Selamat Datang!</h2>
Â  Â  <p class="mb-2">Silakan masukkan nama Anda:</p>
Â  Â  <input id="inputName" type="text" placeholder="Nama Anda"
Â  Â  Â  class="border border-gray-300 p-2 rounded w-full mb-4" />
Â  Â  <button onclick="saveUserName()" class="bg-blue-600 text-white px-4 py-2 rounded w-full">Lanjut</button>
Â  </div>
</div>

<!-- ğŸ” LOGIN PANEL -->
<div id="login" class="hidden max-w-sm mx-auto mt-20 p-6 bg-white rounded-xl shadow">
Â  <h2 class="text-xl font-semibold mb-4">Login Panel</h2>
Â  <input type="text" id="username" placeholder="Username" class="border p-2 rounded w-full mb-2" />
Â  <input type="password" id="password" placeholder="Password" class="border p-2 rounded w-full mb-4" />
Â  <button onclick="doLogin()" class="bg-green-600 text-white px-4 py-2 rounded w-full">Login</button>
</div>

<!-- ğŸ§¾ DASHBOARD -->
<div id="dashboard" class="hidden max-w-xl mx-auto mt-10 p-6 bg-white rounded-xl shadow">
Â  <h2 class="text-2xl font-bold mb-4">QR Pembayaran</h2>
Â  <p class="mb-2 text-sm text-gray-500">ğŸ‘¤ Login sebagai: <span id="userName"></span> (<span id="userRole"></span>)</p>
Â  <p>DANA: <span id="dana" class="font-mono"></span></p>
Â  <p>GOPAY: <span id="gopay" class="font-mono"></span></p>
Â  <p>OVO: <span id="ovo" class="font-mono"></span></p>
Â  <img id="qris" src="" alt="QRIS" class="mt-4 w-40 rounded" />
Â  <button id="adminButton" onclick="showAdmin()" class="mt-6 bg-blue-500 text-white px-4 py-2 rounded">Panel Admin</button>
</div>

<!-- âš™ï¸ ADMIN PANEL -->
<div id="adminPanel" class="hidden max-w-xl mx-auto mt-10 p-6 bg-white rounded-xl shadow">
Â  <h2 class="text-2xl font-bold mb-2">Admin Panel</h2>
Â  <p class="mb-4 text-sm text-gray-500">ğŸ‘¤ Login sebagai: <span id="userNameAdmin"></span></p>
Â  <label class="block mb-2">Edit DANA:</label>
Â  <input id="editDana" class="border p-2 w-full rounded mb-3" />
Â  <label class="block mb-2">Edit GOPAY:</label>
Â  <input id="editGopay" class="border p-2 w-full rounded mb-3" />
Â  <label class="block mb-2">Edit OVO:</label>
Â  <input id="editOvo" class="border p-2 w-full rounded mb-3" />
Â  <label class="block mb-2">Edit Link QRIS:</label>
Â  <input id="editQRIS" class="border p-2 w-full rounded mb-3" />
Â  <button onclick="saveEdit()" class="bg-green-600 text-white px-4 py-2 rounded w-full mb-4">Simpan</button>
Â  <button onclick="backToDashboard()" class="bg-gray-400 text-white px-4 py-2 rounded w-full">Kembali</button>

Â  <h3 class="text-lg font-semibold mt-6 mb-2">Semua Pengguna Login:</h3>
Â  <ul id="allUserList" class="text-sm pl-4 text-gray-700 space-y-1"></ul>

Â  <div id="editUserBox" class="hidden p-4 mt-4 bg-gray-50 rounded border">
Â  Â  <h3 class="font-semibold mb-2">Edit Pengguna</h3>
Â  Â  <input id="editUsername" class="hidden" />
Â  Â  <label class="block text-sm">Nama:</label>
Â  Â  <input id="editName" class="border p-2 w-full rounded mb-2" />
Â  Â  <label class="block text-sm">Role:</label>
Â  Â  <select id="editRole" class="border p-2 w-full rounded mb-2">
Â  Â  Â  <option value="admin">Admin</option>
Â  Â  Â  <option value="user">User</option>
Â  Â  Â  <option value="kasir">Kasir</option>
Â  Â  </select>
Â  Â  <button onclick="saveUserEdit()" class="bg-blue-600 text-white px-4 py-2 rounded w-full">Simpan Perubahan</button>
Â  </div>
</div>

<!-- âœ… TOAST -->
<div id="toast" class="fixed bottom-5 right-5 hidden bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50">
Â  âœ… Berhasil disimpan!
</div>

<!-- ğŸ“œ SCRIPT -->
<script>
Â  const userAccounts = [
Â  Â  { username: "admin", password: "admin123", role: "admin" },
Â  Â  { username: "user1", password: "user123", role: "user" },
Â  Â  { username: "kasir", password: "kasir123", role: "kasir" }
Â  ];

Â  let data = JSON.parse(localStorage.getItem("paymentData")) || {
Â  Â  dana: "0886282627", gopay: "82962829928", ovo: "92829290010",
Â  Â  qris: "https://via.placeholder.com/150"
Â  };

Â  let loginLogs = JSON.parse(localStorage.getItem("loginLogs")) || [];

Â  const welcomePanel = document.getElementById("welcomePanel");
Â  const loginEl = document.getElementById("login");
Â  const dash = document.getElementById("dashboard");
Â  const adminPanel = document.getElementById("adminPanel");

Â  const dana = document.getElementById("dana");
Â  const gopay = document.getElementById("gopay");
Â  const ovo = document.getElementById("ovo");
Â  const qris = document.getElementById("qris");

Â  const editDana = document.getElementById("editDana");
Â  const editGopay = document.getElementById("editGopay");
Â  const editOvo = document.getElementById("editOvo");
Â  const editQRIS = document.getElementById("editQRIS");

Â  function saveUserName() {
Â  Â  const name = document.getElementById("inputName").value.trim();
Â  Â  if (!name) return alert("Nama tidak boleh kosong.");
Â  Â  localStorage.setItem("currentVisitorName", name);
Â  Â  welcomePanel.classList.add("hidden");
Â  Â  loginEl.classList.remove("hidden");
Â  }

Â  function doLogin() {
Â  Â  const username = document.getElementById("username").value.trim();
Â  Â  const password = document.getElementById("password").value.trim();
Â  Â  const user = userAccounts.find(acc => acc.username === username && acc.password === password);
Â  Â  if (!user) return alert("Login gagal!");

Â  Â  localStorage.setItem("currentVisitorName", localStorage.getItem("currentVisitorName") || username);
Â  Â  localStorage.setItem("currentVisitorRole", user.role);
Â  Â  addLoginLog(user.username, user.role);
Â  Â  loginEl.classList.add("hidden");

Â  Â  render();
Â  Â  dash.classList.remove("hidden");
Â  Â  document.getElementById("adminButton").classList.toggle("hidden", user.role !== "admin");
Â  }

Â  function addLoginLog(username, role) {
Â  Â  const name = localStorage.getItem("currentVisitorName") || "Tidak Dikenal";
Â  Â  const timestamp = new Date().toLocaleString();
Â  Â  loginLogs.push({ username, name, role, timestamp });
Â  Â  localStorage.setItem("loginLogs", JSON.stringify(loginLogs));
Â  }

Â  function render() {
Â  Â  dana.textContent = data.dana;
Â  Â  gopay.textContent = data.gopay;
Â  Â  ovo.textContent = data.ovo;
Â  Â  qris.src = data.qris;
Â  Â  document.getElementById("userName").textContent = localStorage.getItem("currentVisitorName") || "-";
Â  Â  document.getElementById("userRole").textContent = localStorage.getItem("currentVisitorRole") || "-";
Â  }

Â  function showAdmin() {
Â  Â  if (localStorage.getItem("currentVisitorRole") !== "admin") return alert("Hanya admin yang dapat mengakses panel ini!");
Â  Â  dash.classList.add("hidden");
Â  Â  adminPanel.classList.remove("hidden");
Â  Â  editDana.value = data.dana;
Â  Â  editGopay.value = data.gopay;
Â  Â  editOvo.value = data.ovo;
Â  Â  editQRIS.value = data.qris;
Â  Â  document.getElementById("userNameAdmin").textContent = localStorage.getItem("currentVisitorName") || "-";
Â  Â  renderAllUsers();
Â  }

Â  function renderAllUsers() {
Â  Â  const allUserList = document.getElementById("allUserList");
Â  Â  const seen = new Set();
Â  Â  allUserList.innerHTML = "";

Â  Â  loginLogs.forEach((log) => {
Â  Â  Â  const key = log.username;
Â  Â  Â  if (!seen.has(key)) {
Â  Â  Â  Â  seen.add(key);
Â  Â  Â  Â  const li = document.createElement("li");
Â  Â  Â  Â  li.className = "flex justify-between items-center bg-gray-100 rounded px-3 py-1";
Â  Â  Â  Â  li.innerHTML = `
Â  Â  Â  Â  Â  <span>${log.name} (${log.username}) - Role: ${log.role}</span>
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <button onclick="startEditUser('${log.username}')" class="text-blue-600 hover:underline mr-2">âœï¸ Edit</button>
Â  Â  Â  Â  Â  Â  <button onclick="deleteUser('${log.username}')" class="text-red-600 hover:underline">ğŸ—‘ï¸ Hapus</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  allUserList.appendChild(li);
Â  Â  Â  }
Â  Â  });
Â  }

Â  function saveEdit() {
Â  Â  data.dana = editDana.value;
Â  Â  data.gopay = editGopay.value;
Â  Â  data.ovo = editOvo.value;
Â  Â  data.qris = editQRIS.value;
Â  Â  localStorage.setItem("paymentData", JSON.stringify(data));
Â  Â  render();
Â  Â  backToDashboard();
Â  Â  showToast("âœ… Data diperbarui");
Â  }

Â  function backToDashboard() {
Â  Â  adminPanel.classList.add("hidden");
Â  Â  dash.classList.remove("hidden");
Â  }

Â  function showToast(message) {
Â  Â  const toast = document.getElementById("toast");
Â  Â  const name = localStorage.getItem("currentVisitorName") || "Pengguna";
Â  Â  toast.textContent = `${message} oleh: ${name}`;
Â  Â  toast.classList.remove("hidden");
Â  Â  setTimeout(() => toast.classList.add("hidden"), 3000);
Â  }

Â  function deleteUser(username) {
Â  Â  if (!confirm(`Yakin ingin menghapus data user "${username}"?`)) return;
Â  Â  loginLogs = loginLogs.filter(log => log.username !== username);
Â  Â  localStorage.setItem("loginLogs", JSON.stringify(loginLogs));
Â  Â  renderAllUsers();
Â  Â  showToast(`ğŸ—‘ï¸ Pengguna ${username} telah dihapus`);
Â  }

Â  function startEditUser(username) {
Â  Â  const user = loginLogs.find(u => u.username === username);
Â  Â  if (!user) return alert("User tidak ditemukan");

Â  Â  document.getElementById("editUsername").value = user.username;
Â  Â  document.getElementById("editName").value = user.name;
Â  Â  document.getElementById("editRole").value = user.role;
Â  Â  document.getElementById("editUserBox").classList.remove("hidden");
Â  }

Â  function saveUserEdit() {
Â  Â  const username = document.getElementById("editUsername").value;
Â  Â  const newName = document.getElementById("editName").value.trim();
Â  Â  const newRole = document.getElementById("editRole").value;

Â  Â  loginLogs = loginLogs.map(log => {
Â  Â  Â  if (log.username === username) {
Â  Â  Â  Â  return { ...log, name: newName, role: newRole };
Â  Â  Â  }
Â  Â  Â  return log;
Â  Â  });

Â  Â  localStorage.setItem("loginLogs", JSON.stringify(loginLogs));
Â  Â  renderAllUsers();
Â  Â  showToast(`âœï¸ Data user "${username}" diperbarui`);
Â  Â  document.getElementById("editUserBox").classList.add("hidden");
Â  }

Â  window.addEventListener("DOMContentLoaded", () => {
Â  Â  if (localStorage.getItem("currentVisitorName")) {
Â  Â  Â  welcomePanel.classList.add("hidden");
Â  Â  Â  loginEl.classList.remove("hidden");
Â  Â  }
Â  });
</script>

</body>
</html>
